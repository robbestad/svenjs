!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):"object"==typeof exports?exports.Svenjs=e():t.Svenjs=e()}(this,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";var o=n(1),r=n(2),i=document.getElementById("ui");o.render(r,i)},function(t,e,n){"use strict";!function(e,n){t.exports=n()}(void 0,function(){return function(t){function e(o){if(n[o])return n[o].exports;var r=n[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){var o;(function(t){var r=n(9),i=n(1),a=n(4),l=n(8),s=n(5),c=n(6),u=n(2),d=n(7),f=n(10),p=n(3),h={version:r.version,updateUI:i.updateUI,setState:s.setState,createStore:f.createStore,createComponent:c.createComponent,render:d.render,lifeCycle:u.lifeCycle,timeTravel:l.timeTravel,saveState:a.saveState,deepCopy:p.deepCopy};"object"==typeof t&&null!=t&&t.exports?t.exports=h:(o=function(){return h}.call(e,n,e,t),!(void 0!==o&&(t.exports=o)))}).call(e,n(11)(t))},function(t,e){e.updateUI=function(t,e,n){}},function(t,e){e.lifeCycle=function(t){t.isMounted&&t.componentDidUpdate.apply(t)}},function(t,e){var n=e.deepCopy=function(t){if(null===t||"object"!=typeof t||"isActiveClone"in t)return t;var e=t.constructor();for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(t.isActiveClone=null,e[o]=n(t[o]),delete t.isActiveClone);return e}},function(t,e,n){var o=n(3);e.saveState=function(t,e){t=t||{history:[],pos:-1},t.history.splice(t.pos+1),t.history.push(o.deepCopy(e)),t.pos++}},function(t,e,n){var o=n(1),r=n(4),i=n(2);e.setState=function(t,e){document.getElementById("ui").innerHTML="",r.saveState(e.time,t),o.updateUI(e,e.render(t)),i.lifeCycle(e)}},function(t,e,n){var o=n(5);e.createComponent=function(t,e){return t._svenjs={rootNode:{}},t.isBound||(t.isBound=!0,t.setState=function(t){return o.setState(t,this)},t.jsx=function(t){console.log("this.jsx"),console.log(this),console.log(t)}),t.isMounted||(t.time={history:[],pos:-1},t.isMounted=!0,void 0!==t.initialState&&(t.state=t.initialState)),t.isMounted&&("function"==typeof t.componentDidMount&&t.componentDidMount.apply(t),"function"==typeof t.render&&(console.log("applying render"),document.getElementById("ui").innerHTML="",t.render.apply(t))),t}},function(t,e,n){function o(t,e){for(var n=t.length-1;n>-1;n--)if(t[n]&&t[n].parentNode){try{t[n].parentNode.removeChild(t[n])}catch(o){}e=[].concat(e),e[n]&&unload(e[n])}t.length&&(t.length=0)}function r(t,e){return function(n){n=n||event,m.redraw.strategy("diff"),m.startComputation();try{return t.call(e,n)}finally{endFirstComputation()}}}function i(t){for(var e=0;e<t.length;e++)Q(t[e])&&(t=t.concat.apply([],t),e--);return t}function a(t,e,n){t.insertBefore(e,t.childNodes[n]||null)}function l(t,e,n,r){v(t,function(t,o){e[t=t.key]=e[t]?{action:Y,index:o,from:e[t].index,element:n.nodes[e[t].index]||_.createElement("div")}:{action:X,index:o}});var i=[];for(var l in e)i.push(e[l]);var s=i.sort(p),c=new Array(n.length);return c.nodes=n.nodes.slice(),g(s,function(e){var i=e.index;if(e.action===W&&(o(n[i].nodes,n[i]),c.splice(i,1)),e.action===X){var l=_.createElement("div");l.key=t[i].attrs.key,a(r,l,i),c.splice(i,0,{attrs:{key:t[i].attrs.key},nodes:[l]}),c.nodes[i]=l}if(e.action===Y){var s=e.element,u=r.childNodes[i];u!==s&&null!==s&&r.insertBefore(s,u||null),c[i]=n[e.from],c.nodes[i]=s}}),c}function s(t,e,n,o){var r=t.length!==e.length;return r||v(t,function(t,n){var o=e[n];return r=o&&o.attrs&&o.attrs.key!==t.key}),r?l(t,n,e,o):e}function c(t,e,n){g(t,function(t,o){null!=e[o]&&n.push.apply(n,e[o].nodes)}),g(e.nodes,function(t,r){null!=t.parentNode&&n.indexOf(t)<0&&o([t],[e[r]])}),t.length<e.length&&(e.length=t.length),e.nodes=n}function u(t){var e=0;v(t,function(){return g(t,function(t){(t=t&&t.attrs)&&null==t.key&&(t.key="__svenjs__"+e++)}),1})}function d(t,e,n,o,r,a,l,d,p){t=i(t);var h=[],g=e.length===t.length,m=0,y={},x=!1;v(e,function(t,n){x=!0,y[e[n].attrs.key]={action:W,index:n}}),u(t),x&&(e=s(t,e,y,n));for(var C=0,b=0,k=t.length;k>b;b++){var S=f(n,r,e,o,t[b],e[C],a,o+m||m,l,d,p);void 0!==S&&(g=g&&S.nodes.intact,m+=w(S),e[C++]=S)}return g||c(t,e,h),e}function f(t,e,n,o,r,i,a,l,s,c,u){return r=S(r),"retain"===r.subtree?i:(i=j(r,i,l,o,n),Q(r)?d(r,i,t,l,e,a,s,c,u):null!=r&&N(r)?A(r,i,s,t,l,a,c,u):E(r)?i:y(i,r,l,t,a,s,e))}function p(t,e){return t.action-e.action||t.index-e.index}function h(t,e,n,o,i){for(var a in n){var l=n[a],s=o[a];if(a in o&&s===l)"value"===a&&"input"===e&&t.value!=l&&(t.value=l);else{o[a]=l;try{if("config"===a||"key"===a){console.log("not real attr");continue}if("onClick"===a)t[a]=l;else if(E(l)&&"on"===a.slice(0,2))console.log("ev handler"),console.log(a),t[a]=r(l,t);else if("style"===a&&null!=l&&N(l)){for(var c in l)(null==s||s[c]!==l[c])&&(t.style[c]=l[c]);for(var c in s)c in l||(t.style[c]="")}else null!=i?"href"===a?t.setAttributeNS("http://www.w3.org/1999/xlink","href",l):t.setAttribute("className"===a?"class":a,l):a in t&&"list"!==a&&"style"!==a&&"form"!==a&&"type"!==a&&"width"!==a&&"height"!==a?("input"!==e||t[a]!==l)&&(t[a]=l):t.setAttribute(a,l)}catch(u){if(u.message.indexOf("Invalid argument")<0)throw u}}}return o}function g(t,e){for(var n=0;n<t.length&&!e(t[n],n++););}function v(t,e){g(t,function(t,n){return(t=t&&t.attrs)&&null!=t.key&&e(t,n)})}function y(t,e,n,o,r,i,a){return 0===t.nodes.length?b(e,o,n):t.valueOf()!==e.valueOf()||r===!0?reattachNodes(e,t,o,i,n,a):(t.nodes.intact=!0,t)}function w(t){if(t.$trusted){var e=t.match(/<[^\/]|\>\s*[^<]/g);if(null!=e)return e.length}else if(Q(t))return t.length;return 1}function x(t,e,n,o,r){if(E(e.attrs.config)){var i=r.configContext=r.configContext||{};t.push(function(){return e.attrs.config.call(e,n,!o,i,r)})}}function C(t,e,n,o,r,i,a,l){var s=t.nodes[0];return console.log("buildUpdatedNode"),console.log(t),o&&h(s,e.tag,e.attrs,t.attrs,r),t.children=f(s,e.tag,void 0,void 0,e.children,t.children,!1,0,e.attrs.contenteditable?s:n,r,a),t.nodes.intact=!0,l.length&&(t.views=i,t.controllers=l),s}function b(t,e,n){var o;t.$trusted?o=injectHTML(e,n,t):(o=[_.createTextNode(t)],e.nodeName.match(tt)||a(e,o[0],n));var r="string"==typeof t||"number"==typeof t||"boolean"==typeof t?new t.constructor(t):t;return r.nodes=o,r}function k(t,e,n){n.length&&(t.views=e,t.controllers=n,g(n,function(t){if(t.onunload&&t.onunload.$old&&(t.onunload=t.onunload.$old),pendingRequests&&t.onunload){var e=t.onunload;t.onunload=et,t.onunload.$old=e}}))}function S(t){try{if(null==t||null==t.toString())return""}catch(e){return""}return t}function E(t){return"function"==typeof t}function N(t){return"[object Object]"===Z.call(t)}function M(t){return"[object String]"===Z.call(t)}function j(t,e,n,r,i){if(null!=e){if(Z.call(e)===Z.call(t))return e;if(i&&i.nodes){var a=n-r,l=a+(Q(t)?t:e.nodes).length;o(i.nodes.slice(a,l),i.slice(a,l))}else e.nodes&&o(e.nodes,e)}return e=new t.constructor,e.tag&&(e={}),e.nodes=[],e}function A(t,e,n,o,r,i,l,s){var c=[],u=[];if(t=L(t,e,c,u),!t.tag&&u.length)throw new Error("Component template must return a virtual element, not an array, string, etc.");t.attrs=t.attrs||{},e.attrs=e.attrs||{};var d=Object.keys(t.attrs),f=d.length>("key"in t.attrs?1:0);if(F(t,e,d),M(t.tag)){var p=0===e.nodes.length;l=$(t,l);var h;if(p){h=T(t,l);var g=O(t,h,l,f),v=B(t,h,e,n,l,s);e=I(t,g,v,h,l,c,u)}else h=C(e,t,n,f,l,c,s,u);return(p||i===!0&&null!=h)&&a(o,h,r),x(s,t,h,p,e),e}}function T(t,e){return void 0===e?t.attrs.is?_.createElement(t.tag,t.attrs.is):_.createElement(t.tag):t.attrs.is?_.createElementNS(e,t.tag,t.attrs.is):_.createElementNS(e,t.tag)}function O(t,e,n,o){return o?h(e,t.tag,t.attrs,{},n):t.attrs}function B(t,e,n,o,r,i){return null!=t.children&&t.children.length>0?f(e,t.tag,void 0,void 0,t.children,n.children,!0,0,t.attrs.contenteditable?e:o,r,i):t.children}function I(t,e,n,o,r,i,a){var l={tag:t.tag,attrs:e,children:n,nodes:[o]};return k(l,i,a),l.children&&!l.children.nodes&&(l.children.nodes=[]),"select"===t.tag&&"value"in t.attrs&&h(o,t.tag,{value:t.attrs.value},{},r),l}function R(t,e,n,o){console.log("getController");var r="diff"===m.redraw.strategy()&&t?t.indexOf(e):-1;return r>-1?n[r]:"function"==typeof o?new o:{}}function U(t,e,n,o){null!=o.onunload&&unloaders.push({controller:o,handler:o.onunload}),t.push(n),e.push(o)}function D(t,e,n,o,r,i){console.log("checkView");var a=R(n.views,e,o,t.controller),l=+(t&&t.attrs&&t.attrs.key);return t=0===pendingRequests||forcing||o&&o.indexOf(a)>-1?t.view(a):{tag:"placeholder"},"retain"===t.subtree?n:(l===l&&((t.attrs=t.attrs||{}).key=l),U(i,r,e,a),t)}function L(t,e,n,o){for(var r=e&&e.controllers;null!=t.view;)t=D(t,t.view.$original||t.view,e,r,o,n);return t}function F(t,e,n){(t.tag!==e.tag||n.sort().join()!==Object.keys(e.attrs).sort().join()||t.attrs.id!==e.attrs.id||t.attrs.key!==e.attrs.key||"all"===m.redraw.strategy()&&(!e.configContext||e.configContext.retain!==!0)||"diff"===m.redraw.strategy()&&e.configContext&&e.configContext.retain===!1)&&(e.nodes.length&&o(e.nodes),e.configContext&&E(e.configContext.onunload)&&e.configContext.onunload(),e.controllers&&g(e.controllers,function(t){t.unload&&t.onunload({preventDefault:et})}))}function $(t,e){return t.attrs.xmlns?t.attrs.xmlns:"svg"===t.tag?"http://www.w3.org/2000/svg":"math"===t.tag?"http://www.w3.org/1998/Math/MathML":e}function H(t){var e=J.indexOf(t);return 0>e?J.push(t)-1:e}var P,_,q,G,K,J=(n(1),[]),z={},V={appendChild:function(t){void 0===P&&(P=_.createElement("html")),_.documentElement&&_.documentElement!==t?_.replaceChild(t,_.documentElement):_.appendChild(t),this.childNodes=_.childNodes},insertBefore:function(t){this.appendChild(t)},childNodes:[]},W=(function(){_=document,q=window.location,K=window.cancelAnimationFrame||window.clearTimeout,G=window.requestAnimationFrame||window.setTimeout}(),1),X=2,Y=3,Q=Array.isArray||function(t){return"[object Array]"===Z.call(t)},Z={}.toString,tt=/^(AREA|BASE|BR|COL|COMMAND|EMBED|HR|IMG|INPUT|KEYGEN|LINK|META|PARAM|SOURCE|TRACK|WBR)$/,et=function(){};e.render=function(t,e,n){t._svenjs.rootNode=e;var r=t.render(),i=[];if(!e)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var a=H(e),l=e===_,s=l||e===_.documentElement?V:e;l&&"html"!==cell.tag&&(cell={tag:"html",attrs:{},children:cell}),void 0===z[a]&&o(s.childNodes),n===!0&&reset(e),z[a]=f(s,null,void 0,void 0,r,z[a],!1,0,null,void 0,i),g(i,function(t){t()})}},function(t,e,n){var o=n(3),r=n(1),i=n(2);e.timeTravel=function(t,e){document.getElementById("ui").innerHTML="";var n=t.time,a=t.state;n.pos+=e,a=o.deepCopy(n.history[n.pos]),t.state=a,r.updateUI(t,t.render(a),n),i.lifeCycle(t)}},function(t,e){var n="0.0.2-alpha";e.version=function(){return n}},function(t,e){var n=[];e.createStore=function(t){return t.isMounted||(t.listenTo=function(t){n.push(t)},t.emit=function(t){n.forEach(function(e){e(t)})},"function"==typeof t.init&&t.init.apply(t)),t}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}}])})},function(t,e,n){"use strict";var o=n(1),r=n(4),i=o.createComponent({displayName:"First app",initialState:{items:[],message:""},componentDidMount:function(){r.listenTo(this.onEmit)},componentDidUpdate:function(){},onEmit:function(t){console.log("data from store received!"),console.log(t)},handleClick:function(t){console.log("clicking myFunc"),state.items.push(this.getNextString()),state.message="BOB"+(1+Math.floor(100*Math.random()))+"!",this.setState(state)},goBack:function(){o.timeTravel(this,-1)},goForward:function(){o.timeTravel(this,1)},getNextString:function(){var t="The quick brown fox jumps over the lazy dog".split(" ");return t[Math.floor(Math.random()*t.length)]},render:function(){var t=(this.state,this.time),e=t.pos>=t.history.length-1?"disabled":"false",n=t.pos<=0?"disabled":"false";return{tag:"div",attrs:{id:"row"},children:[{tag:"div",attrs:{id:"app"},children:[{tag:"h3",attrs:{},children:[this.state.message||"Svenjs App"]},{tag:"button",attrs:{onClick:this.handleClick},children:["Add word"]},{tag:"div",attrs:{id:"ui"}},{tag:"small",attrs:{},children:["(click word to delete)"]}]},{tag:"div",attrs:{id:"time-travel"},children:[{tag:"h3",attrs:{},children:["Time travel"]},{tag:"button",attrs:{disabled:n,onClick:this.goBack.bind(this)},children:["Back"]},{tag:"button",attrs:{disabled:e,onClick:this.goForward.bind(this)},children:["Next"]},{tag:"p",attrs:{id:"time-pos"}}]}]}}});t.exports=i},function(t,e){"use strict";e.getJSON=function(t){return new Promise(function(e,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){4===o.readyState&&(200===o.status?e(JSON.parse(o.responseText)):n(o.responseText))},o.open("GET",t),o.send()})}},function(t,e,n){"use strict";var o=(n(3),n(1));t.exports=o.createStore({init:function(){}})}])});